<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chronicle - Cercles Familiaux</title>
    <style>
        :root {
            --gold-primary: #D4AF37;
            --gold-light: #E8C574;
            --gold-glow: rgba(212, 175, 55, 0.6);
            --space-dark: #0a0e1a;
            --space-medium: #1a2d47;
            --space-light: #2d4a6e;
            --text-primary: #F5F5F0;
            --text-secondary: rgba(245, 245, 240, 0.7);
            --card-bg: rgba(26, 45, 71, 0.95);
            --overlay-bg: rgba(10, 14, 26, 0.85);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(180deg, var(--space-dark) 0%, var(--space-medium) 50%, var(--space-light) 100%);
            min-height: 100vh;
            overflow-x: hidden;
            color: var(--text-primary);
        }

        .atmospheric-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(45, 74, 110, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(26, 45, 71, 0.3) 0%, transparent 50%),
                linear-gradient(180deg, #0a0e1a 0%, #1a2d47 50%, #2d4a6e 100%);
            animation: atmosphere-shift 20s ease-in-out infinite;
            z-index: 1;
        }

        @keyframes atmosphere-shift {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 1; }
            50% { transform: scale(1.05) rotate(1deg); opacity: 0.95; }
        }

        .stars-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            pointer-events: none;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s ease-in-out infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 70px;
            background: rgba(13, 20, 37, 0.95);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            z-index: 100;
        }

        .logo {
            font-size: 24px;
            font-weight: 800;
            background: linear-gradient(135deg, #D4AF37 0%, #FFD700 50%, #E8C574 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 2px;
            cursor: pointer;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--gold-primary), var(--gold-light));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid rgba(212, 175, 55, 0.3);
        }

        .user-avatar:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px var(--gold-glow);
        }

        .main-content {
            position: relative;
            z-index: 10;
            padding-top: 100px;
            padding-bottom: 50px;
            min-height: 100vh;
        }

        .page-title-section {
            text-align: center;
            margin-bottom: 50px;
            opacity: 0;
            animation: fade-slide-in 0.8s ease-out 0.3s forwards;
        }

        @keyframes fade-slide-in {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .page-title {
            font-size: 36px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 10px;
            letter-spacing: 1px;
        }

        .page-subtitle {
            font-size: 16px;
            color: var(--text-secondary);
            font-weight: 300;
            letter-spacing: 0.5px;
        }

        .circles-container {
            position: relative;
            width: 100%;
            min-height: calc(100vh - 170px);
            padding: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 80px;
        }

        .circle-halo {
            position: relative;
            width: 280px;
            height: 280px;
            cursor: pointer;
            opacity: 0;
            transform: scale(0.5) rotate(-180deg);
            animation: halo-float-in 1s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        .circle-halo:nth-child(1) { animation-delay: 0.5s; }
        .circle-halo:nth-child(2) { animation-delay: 0.7s; }
        .circle-halo:nth-child(3) { animation-delay: 0.9s; }
        .circle-halo:nth-child(4) { animation-delay: 1.1s; }

        @keyframes halo-float-in {
            0% {
                opacity: 0;
                transform: scale(0.5) rotate(-180deg);
            }
            60% {
                opacity: 1;
                transform: scale(1.08) rotate(10deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }

        .halo-core {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 220px;
            height: 220px;
            border-radius: 50%;
            background: radial-gradient(
                circle,
                rgba(212, 175, 55, 0.25) 0%,
                rgba(255, 215, 0, 0.15) 30%,
                rgba(212, 175, 55, 0.1) 60%,
                transparent 100%
            );
            border: 2px solid rgba(212, 175, 55, 0.4);
            box-shadow: 
                0 0 60px rgba(212, 175, 55, 0.5),
                0 0 100px rgba(232, 197, 116, 0.3),
                inset 0 0 40px rgba(255, 215, 0, 0.15);
            backdrop-filter: blur(10px);
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            animation: halo-pulse 4s ease-in-out infinite;
        }

        @keyframes halo-pulse {
            0%, 100% {
                box-shadow: 
                    0 0 60px rgba(212, 175, 55, 0.5),
                    0 0 100px rgba(232, 197, 116, 0.3),
                    inset 0 0 40px rgba(255, 215, 0, 0.15);
                transform: translate(-50%, -50%) scale(1);
            }
            50% {
                box-shadow: 
                    0 0 90px rgba(212, 175, 55, 0.8),
                    0 0 140px rgba(232, 197, 116, 0.5),
                    inset 0 0 60px rgba(255, 215, 0, 0.25);
                transform: translate(-50%, -50%) scale(1.03);
            }
        }

        .circle-halo:hover .halo-core {
            transform: translate(-50%, -50%) scale(1.12);
            border-color: var(--gold-primary);
            box-shadow: 
                0 0 100px rgba(212, 175, 55, 1),
                0 0 160px rgba(232, 197, 116, 0.7),
                inset 0 0 80px rgba(255, 215, 0, 0.35);
        }

        .halo-ring {
            position: absolute;
            top: 50%;
            left: 50%;
            border-radius: 50%;
            border: 1px solid rgba(212, 175, 55, 0.25);
            pointer-events: none;
        }

        .halo-ring.ring-1 {
            width: 240px;
            height: 240px;
            transform: translate(-50%, -50%);
            animation: ring-rotate 15s linear infinite;
        }

        .halo-ring.ring-2 {
            width: 260px;
            height: 260px;
            transform: translate(-50%, -50%);
            animation: ring-rotate-reverse 20s linear infinite;
            border-style: dashed;
            opacity: 0.6;
        }

        @keyframes ring-rotate {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }

        @keyframes ring-rotate-reverse {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(-360deg); }
        }

        .circle-icon {
            font-size: 72px;
            margin-bottom: 12px;
            filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.4));
            animation: icon-float 3s ease-in-out infinite;
        }

        @keyframes icon-float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-6px); }
        }

        .circle-name {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.6);
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 4px;
        }

        .circle-member-count {
            font-size: 12px;
            color: var(--gold-light);
            font-weight: 500;
            letter-spacing: 0.5px;
            opacity: 0.9;
        }

        .circle-members {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .member-orbit {
            position: absolute;
            width: 45px;
            height: 45px;
            top: 50%;
            left: 50%;
            pointer-events: all;
        }

        .member-avatar {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--card-bg), var(--space-light));
            border: 2px solid var(--gold-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 
                0 4px 12px rgba(0, 0, 0, 0.4),
                0 0 15px rgba(212, 175, 55, 0.3);
            animation: orbit-member 20s linear infinite;
        }

        .member-avatar:hover {
            transform: scale(1.3);
            box-shadow: 
                0 6px 20px rgba(0, 0, 0, 0.6),
                0 0 25px var(--gold-glow);
            z-index: 100;
        }

        @keyframes orbit-member {
            from {
                transform: rotate(0deg) translateX(130px) rotate(0deg);
            }
            to {
                transform: rotate(360deg) translateX(130px) rotate(-360deg);
            }
        }

        .member-avatar.add-member {
            background: rgba(212, 175, 55, 0.2);
            border-style: dashed;
            font-size: 28px;
            color: var(--gold-light);
            backdrop-filter: blur(5px);
        }

        .member-avatar.add-member:hover {
            background: rgba(212, 175, 55, 0.35);
            border-style: solid;
        }

        .member-tooltip {
            position: absolute;
            bottom: -40px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(13, 20, 37, 0.95);
            backdrop-filter: blur(10px);
            padding: 8px 14px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            border: 1px solid rgba(212, 175, 55, 0.4);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .member-avatar:hover .member-tooltip {
            opacity: 1;
        }

        .circle-halo.add-circle .halo-core {
            border-style: dashed;
            border-width: 3px;
            background: radial-gradient(
                circle,
                rgba(212, 175, 55, 0.15) 0%,
                rgba(212, 175, 55, 0.08) 50%,
                transparent 100%
            );
        }

        .circle-halo.add-circle:hover .halo-core {
            border-style: solid;
            background: radial-gradient(
                circle,
                rgba(212, 175, 55, 0.25) 0%,
                rgba(212, 175, 55, 0.15) 50%,
                transparent 100%
            );
        }

        .add-circle-icon {
            font-size: 72px;
            opacity: 0.7;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .circle-halo.add-circle:hover .add-circle-icon {
            opacity: 1;
            transform: rotate(90deg) scale(1.15);
        }

        .add-circle-text {
            font-size: 14px;
            font-weight: 600;
            color: var(--gold-light);
            letter-spacing: 1px;
            text-transform: uppercase;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.6);
        }

        /* MODALES - styles complets dans ton fichier original */
        /* Je garde seulement les styles essentiels ici pour la longueur */
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--overlay-bg);
            backdrop-filter: blur(10px);
            z-index: 500;
            display: none;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: var(--card-bg);
            border: 2px solid var(--gold-primary);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            transform: scale(0.9);
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .modal-overlay.active .modal-content {
            transform: scale(1);
        }

        /* Reste des styles de ton fichier... */
    </style>
</head>
<body>
    <div class="atmospheric-bg"></div>
    <div class="stars-layer" id="starsLayer"></div>

    <header class="header">
        <div class="logo" onclick="window.location.href='index.html'">CHRONICLE</div>
        <div class="header-actions">
            <div class="user-avatar">👤</div>
        </div>
    </header>

    <main class="main-content">
        <div class="page-title-section">
            <h1 class="page-title">Vos Cercles Familiaux</h1>
            <p class="page-subtitle">Organisez vos souvenirs par cercles de vie</p>
        </div>

        <div class="circles-container" id="circlesContainer"></div>
    </main>

    <script src="js/storage.js"></script>
    <script>
        const STORAGE_KEY = 'chronicle_data';

        function getData() {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : { circles: [], members: [], events: [], memories: [] };
        }

        function saveData(data) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        }

        function createStars() {
            const starsLayer = document.getElementById('starsLayer');
            for (let i = 0; i < 60; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                const size = 1 + Math.random() * 2;
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                starsLayer.appendChild(star);
            }
        }

        function renderCircles() {
            const container = document.getElementById('circlesContainer');
            container.innerHTML = '';
            const data = getData();

            if (data.circles.length === 0) {
                const family = {
                    id: 'circle_' + Date.now(),
                    name: 'Famille',
                    icon: '👨‍👩‍👧‍👦',
                    memberCount: 1
                };
                data.circles.push(family);
                data.members.push({
                    id: 'member_' + Date.now(),
                    circleId: family.id,
                    name: 'Moi',
                    avatar: '👤',
                    isAdmin: true
                });
                saveData(data);
            }

            data.circles.forEach(circle => {
                const members = data.members.filter(m => m.circleId === circle.id);
                const halo = createCircleHalo(circle, members);
                container.appendChild(halo);
            });

            const addHalo = createAddCircleHalo();
            container.appendChild(addHalo);
        }

        function createCircleHalo(circle, members) {
            const halo = document.createElement('div');
            halo.className = 'circle-halo';
            halo.onclick = () => window.location.href = `timeline.html?circleId=${circle.id}`;

            const ring1 = document.createElement('div');
            ring1.className = 'halo-ring ring-1';
            
            const ring2 = document.createElement('div');
            ring2.className = 'halo-ring ring-2';

            const core = document.createElement('div');
            core.className = 'halo-core';
            core.innerHTML = `
                <div class="circle-icon">${circle.icon}</div>
                <div class="circle-name">${circle.name}</div>
                <div class="circle-member-count">${members.length} membre${members.length > 1 ? 's' : ''}</div>
            `;

            const membersContainer = document.createElement('div');
            membersContainer.className = 'circle-members';

            members.forEach((member, index) => {
                const memberOrbit = document.createElement('div');
                memberOrbit.className = 'member-orbit';
                
                const angle = (index * 360) / (members.length + 1);
                memberOrbit.style.animationDelay = `${-index * (20 / (members.length + 1))}s`;
                memberOrbit.style.transform = `rotate(${angle}deg)`;

                const avatar = document.createElement('div');
                avatar.className = 'member-avatar';
                avatar.innerHTML = `
                    ${member.avatar}
                    <div class="member-tooltip">${member.name}</div>
                `;
                avatar.onclick = (e) => {
                    e.stopPropagation();
                    window.location.href = `timeline.html?memberId=${member.id}`;
                };

                memberOrbit.appendChild(avatar);
                membersContainer.appendChild(memberOrbit);
            });

            halo.appendChild(ring1);
            halo.appendChild(ring2);
            halo.appendChild(core);
            halo.appendChild(membersContainer);

            return halo;
        }

        function createAddCircleHalo() {
            const halo = document.createElement('div');
            halo.className = 'circle-halo add-circle';
            halo.onclick = () => alert('Fonctionnalité à venir !');

            const ring1 = document.createElement('div');
            ring1.className = 'halo-ring ring-1';
            
            const ring2 = document.createElement('div');
            ring2.className = 'halo-ring ring-2';

            const core = document.createElement('div');
            core.className = 'halo-core';
            core.innerHTML = `
                <div class="add-circle-icon">➕</div>
                <div class="add-circle-text">Nouveau cercle</div>
            `;

            halo.appendChild(ring1);
            halo.appendChild(ring2);
            halo.appendChild(core);

            return halo;
        }

        document.addEventListener('DOMContentLoaded', () => {
            createStars();
            renderCircles();
        });
    </script>
</body>
</html>
