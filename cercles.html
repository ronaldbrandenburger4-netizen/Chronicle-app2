<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chronicle - Cercles</title>
    <style>
        :root {
            --gold-primary: #D4AF37;
            --gold-light: #E8C574;
            --gold-glow: rgba(212, 175, 55, 0.6);
            --space-dark: #0a0e1a;
            --space-medium: #1a2d47;
            --space-light: #2d4a6e;
            --text-primary: #F5F5F0;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(180deg, var(--space-dark) 0%, var(--space-medium) 50%, var(--space-light) 100%);
            min-height: 100vh;
            overflow-x: hidden;
            color: var(--text-primary);
        }

        .atmospheric-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 80%, rgba(45, 74, 110, 0.3) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(26, 45, 71, 0.3) 0%, transparent 50%);
            animation: atmosphere-shift 20s ease-in-out infinite;
            z-index: 1;
        }

        @keyframes atmosphere-shift {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.95; }
        }

        .stars-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            pointer-events: none;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s ease-in-out infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 70px;
            background: rgba(13, 20, 37, 0.95);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            z-index: 100;
        }

        .logo {
            font-size: 24px;
            font-weight: 800;
            background: linear-gradient(135deg, #D4AF37 0%, #FFD700 50%, #E8C574 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 2px;
            cursor: pointer;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--gold-primary), var(--gold-light));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            border: 2px solid rgba(212, 175, 55, 0.3);
        }

        .main-content {
            position: relative;
            z-index: 10;
            padding-top: 100px;
            padding-bottom: 50px;
            min-height: 100vh;
        }

        .page-title-section {
            text-align: center;
            margin-bottom: 50px;
            opacity: 0;
            animation: fade-slide-in 0.8s ease-out 0.3s forwards;
        }

        @keyframes fade-slide-in {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page-title {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .page-subtitle {
            font-size: 16px;
            color: rgba(245, 245, 240, 0.7);
        }

        .circles-container {
            position: relative;
            width: 100%;
            min-height: calc(100vh - 200px);
            padding: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 100px;
        }

        .circle-halo {
            position: relative;
            width: 280px;
            height: 280px;
            cursor: pointer;
            opacity: 0;
            animation: halo-float-in 1s ease forwards;
        }

        .circle-halo:nth-child(1) { animation-delay: 0.5s; }
        .circle-halo:nth-child(2) { animation-delay: 0.7s; }
        .circle-halo:nth-child(3) { animation-delay: 0.9s; }

        @keyframes halo-float-in {
            0% { opacity: 0; transform: scale(0.5); }
            100% { opacity: 1; transform: scale(1); }
        }

        .halo-core {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 220px;
            height: 220px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(212, 175, 55, 0.25), transparent);
            border: 2px solid rgba(212, 175, 55, 0.4);
            box-shadow: 0 0 60px rgba(212, 175, 55, 0.5),
                        0 0 100px rgba(232, 197, 116, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            animation: halo-pulse 4s ease-in-out infinite;
        }

        @keyframes halo-pulse {
            0%, 100% { box-shadow: 0 0 60px rgba(212, 175, 55, 0.5); }
            50% { box-shadow: 0 0 90px rgba(212, 175, 55, 0.8); }
        }

        .halo-ring {
            position: absolute;
            top: 50%;
            left: 50%;
            border-radius: 50%;
            border: 1px solid rgba(212, 175, 55, 0.25);
            pointer-events: none;
        }

        .halo-ring.ring-1 {
            width: 240px;
            height: 240px;
            transform: translate(-50%, -50%);
            animation: ring-rotate 15s linear infinite;
        }

        .halo-ring.ring-2 {
            width: 260px;
            height: 260px;
            transform: translate(-50%, -50%);
            animation: ring-rotate-reverse 20s linear infinite;
            border-style: dashed;
        }

        @keyframes ring-rotate {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }

        @keyframes ring-rotate-reverse {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(-360deg); }
        }

        .circle-icon {
            font-size: 72px;
            margin-bottom: 12px;
            animation: icon-float 3s ease-in-out infinite;
        }

        @keyframes icon-float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-6px); }
        }

        .circle-name {
            font-size: 18px;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 4px;
        }

        .circle-member-count {
            font-size: 12px;
            color: var(--gold-light);
        }

        .circle-members {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .member-orbit {
            position: absolute;
            width: 45px;
            height: 45px;
            top: 50%;
            left: 50%;
            pointer-events: all;
        }

        .member-avatar {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(26, 45, 71, 0.95), var(--space-light));
            border: 2px solid var(--gold-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            animation: orbit-member 20s linear infinite;
            transition: all 0.3s ease;
        }

        .member-avatar:hover {
            transform: scale(1.3);
            box-shadow: 0 0 25px var(--gold-glow);
            z-index: 100;
        }

        @keyframes orbit-member {
            from { transform: rotate(0deg) translateX(130px) rotate(0deg); }
            to { transform: rotate(360deg) translateX(130px) rotate(-360deg); }
        }

        .member-avatar.add-member {
            background: rgba(212, 175, 55, 0.2);
            border-style: dashed;
            font-size: 28px;
            color: var(--gold-light);
        }

        .member-tooltip {
            position: absolute;
            bottom: -40px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(13, 20, 37, 0.95);
            padding: 8px 14px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            border: 1px solid rgba(212, 175, 55, 0.4);
            z-index: 1000;
        }

        .member-avatar:hover .member-tooltip {
            opacity: 1;
        }

        .circle-halo.add-circle .halo-core {
            border-style: dashed;
            background: radial-gradient(circle, rgba(212, 175, 55, 0.15), transparent);
        }

        .add-circle-icon {
            font-size: 72px;
            opacity: 0.7;
            transition: all 0.4s ease;
        }

        .circle-halo.add-circle:hover .add-circle-icon {
            opacity: 1;
            transform: rotate(90deg) scale(1.15);
        }

        .add-circle-text {
            font-size: 14px;
            font-weight: 600;
            color: var(--gold-light);
            text-transform: uppercase;
        }

        @media (max-width: 768px) {
            .page-title { font-size: 28px; }
            .circles-container { gap: 60px; padding: 20px; }
            .circle-halo { width: 240px; height: 240px; }
            .halo-core { width: 190px; height: 190px; }
            .circle-icon { font-size: 56px; }
            @keyframes orbit-member {
                from { transform: rotate(0deg) translateX(105px) rotate(0deg); }
                to { transform: rotate(360deg) translateX(105px) rotate(-360deg); }
            }
        }
    </style>
</head>
<body>
    <div class="atmospheric-bg"></div>
    <div class="stars-layer" id="starsLayer"></div>

    <header class="header">
        <div class="logo" onclick="window.location.href='index.html'">CHRONICLE</div>
        <div class="user-avatar">👤</div>
    </header>

    <main class="main-content">
        <div class="page-title-section">
            <h1 class="page-title">Vos Cercles Familiaux</h1>
            <p class="page-subtitle">Organisez vos souvenirs par cercles de vie</p>
        </div>

        <div class="circles-container" id="circlesContainer"></div>
    </main>

    <script>
        const STORAGE_KEY = 'chronicle_data';

        function getData() {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : { circles: [], members: [] };
        }

        function saveData(data) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        }

        function createStars() {
            const layer = document.getElementById('starsLayer');
            for (let i = 0; i < 60; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                const size = 1 + Math.random() * 2;
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                layer.appendChild(star);
            }
        }

        function renderCircles() {
            const container = document.getElementById('circlesContainer');
            container.innerHTML = '';
            const data = getData();

            // Créer cercles par défaut si vide
            if (data.circles.length === 0) {
                data.circles = [
                    { id: 'famille', name: 'Famille', icon: '👨‍👩‍👧‍👦', members: [
                        { id: 'm1', avatar: '👨', name: 'Papa' },
                        { id: 'm2', avatar: '👩', name: 'Maman' },
                        { id: 'm3', avatar: '👧', name: 'Sophie' },
                        { id: 'm4', avatar: '👤', name: 'Moi' }
                    ]},
                    { id: 'amis', name: 'Amis', icon: '🎉', members: [
                        { id: 'm5', avatar: '👨', name: 'Thomas' },
                        { id: 'm6', avatar: '👩', name: 'Julie' },
                        { id: 'm7', avatar: '🧑', name: 'Alex' }
                    ]},
                    { id: 'travail', name: 'Travail', icon: '💼', members: [
                        { id: 'm8', avatar: '👨‍💼', name: 'Marc' }
                    ]}
                ];
                saveData(data);
            }

            // Afficher les cercles
            data.circles.forEach(circle => {
                const halo = createCircleHalo(circle);
                container.appendChild(halo);
            });

            // Cercle d'ajout
            const addHalo = createAddCircleHalo();
            container.appendChild(addHalo);
        }

        function createCircleHalo(circle) {
            const halo = document.createElement('div');
            halo.className = 'circle-halo';

            const ring1 = document.createElement('div');
            ring1.className = 'halo-ring ring-1';
            
            const ring2 = document.createElement('div');
            ring2.className = 'halo-ring ring-2';

            const core = document.createElement('div');
            core.className = 'halo-core';
            core.innerHTML = `
                <div class="circle-icon">${circle.icon}</div>
                <div class="circle-name">${circle.name}</div>
                <div class="circle-member-count">${circle.members.length} membre${circle.members.length > 1 ? 's' : ''}</div>
            `;

            const membersContainer = document.createElement('div');
            membersContainer.className = 'circle-members';

            circle.members.forEach((member, index) => {
                const memberOrbit = document.createElement('div');
                memberOrbit.className = 'member-orbit';
                
                const angle = (index * 360) / (circle.members.length + 1);
                memberOrbit.style.animationDelay = `${-index * (20 / (circle.members.length + 1))}s`;
                memberOrbit.style.transform = `rotate(${angle}deg)`;

                const avatar = document.createElement('div');
                avatar.className = 'member-avatar';
                avatar.innerHTML = `
                    ${member.avatar}
                    <div class="member-tooltip">${member.name}</div>
                `;
                avatar.onclick = (e) => {
                    e.stopPropagation();
                    window.location.href = `timeline.html?memberId=${member.id}`;
                };

                memberOrbit.appendChild(avatar);
                membersContainer.appendChild(memberOrbit);
            });

            // Bouton ajouter membre
            const addMemberOrbit = document.createElement('div');
            addMemberOrbit.className = 'member-orbit';
            const lastAngle = (circle.members.length * 360) / (circle.members.length + 1);
            addMemberOrbit.style.transform = `rotate(${lastAngle}deg)`;

            const addMemberBtn = document.createElement('div');
            addMemberBtn.className = 'member-avatar add-member';
            addMemberBtn.innerHTML = `+<div class="member-tooltip">Ajouter</div>`;
            addMemberBtn.onclick = (e) => {
                e.stopPropagation();
                alert('Ajouter un membre - Fonctionnalité à venir !');
            };

            addMemberOrbit.appendChild(addMemberBtn);
            membersContainer.appendChild(addMemberOrbit);

            halo.appendChild(ring1);
            halo.appendChild(ring2);
            halo.appendChild(core);
            halo.appendChild(membersContainer);

            return halo;
        }

        function createAddCircleHalo() {
            const halo = document.createElement('div');
            halo.className = 'circle-halo add-circle';
            halo.onclick = () => alert('Nouveau cercle - Fonctionnalité à venir !');

            const ring1 = document.createElement('div');
            ring1.className = 'halo-ring ring-1';
            
            const ring2 = document.createElement('div');
            ring2.className = 'halo-ring ring-2';

            const core = document.createElement('div');
            core.className = 'halo-core';
            core.innerHTML = `
                <div class="add-circle-icon">➕</div>
                <div class="add-circle-text">Nouveau cercle</div>
            `;

            halo.appendChild(ring1);
            halo.appendChild(ring2);
            halo.appendChild(core);

            return halo;
        }

        document.addEventListener('DOMContentLoaded', () => {
            createStars();
            renderCircles();
        });
    </script>
</body>
</html>
